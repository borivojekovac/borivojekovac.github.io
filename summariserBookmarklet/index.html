<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Transcript Summariser Bookmarklet</title>
</head>
<body>
    <h1>Transcript Summariser Bookmarklet</h1>
    <p>
        Drag and drop the link below to your bookmarks.
    </p>
    <p>
        While on Microsoft Stream, click the bookmark, and
        then click the transcript you want summarised.
        Alternativelym use it on any page to get summary 
        of the whole page contents.        
    </p>
    <p>
        First time you use the script on a domain, it will
        prompt you for an OpenAI API key. From then on will
        store it in a cookie and reuse.
    </p>
    <a href='javascript:(function(){ var script = document.createElement("script"); script.src = "https://borivojekovac.github.io/summariserBookmarklet/summariserBookmarklet.js"; document.body.appendChild(script); })()'>Summarise!</a>
    <script>
        // Listen for messages from the parent page
        window.addEventListener("message", (event) => {
          // Only allow messages from the same origin
          if (event.origin !== window.location.origin) return;
    
          const { action, key, value } = event.data;
    
          if (action === "get") {
            // Return the key value to the parent
            event.source.postMessage({ action: "get", key, value: localStorage.getItem(key) }, event.origin);
          } else if (action === "set") {
            // Save the key-value pair in localStorage
            localStorage.setItem(key, value);
            event.source.postMessage({ action: "set", key, success: true }, event.origin);
          }
        });
      </script>
</body>
</html>